#%%
from ribasim_nl import CloudStorage
import geopandas as gpd
import pandas as pd
from pathlib import Path

storage = CloudStorage()
out_gpkg = Path(r"D:\repositories\hydrobase\data\rijkswateren\database.gpkg")

hhnk_gpkg = storage.joinpath("HollandsNoorderkwartier", "modellen", "HHNK_Ribasim", "HHNK.gpkg")
rws_gpkg = storage.joinpath("Rijkswaterstaat", "modellen", "Rijkswateren", "database.gpkg")

out_gpkg.unlink()

# %%

rws_node_gdf = gpd.read_file(rws_gpkg, layer="Node", engine="pyogrio")
rws_node_gdf["zoom_level"] = 0
hhnk_node_gdf = gpd.read_file(hhnk_gpkg, layer="Node", engine="pyogrio")
hhnk_node_gdf["zoom_level"] = 3
node_gdf = pd.concat(
    [rws_node_gdf,
     hhnk_node_gdf])

node_gdf.to_file(out_gpkg, layer="Node", engine="pyogrio")


rws_edge_gdf = gpd.read_file(rws_gpkg, layer="Edge", engine="pyogrio")
rws_edge_gdf["zoom_level"] = 0
hhnk_edge_gdf = gpd.read_file(hhnk_gpkg, layer="Edge", engine="pyogrio")
hhnk_edge_gdf["zoom_level"] = 3

edge_gdf = pd.concat([rws_edge_gdf,hhnk_edge_gdf])



edge_gdf.to_file(out_gpkg, layer="Edge", engine="pyogrio")



# %%
